---

---

<div
	class="relative w-full aspect-[1027/716] rounded-lg shadow-2xl overflow-hidden group"
>
	<!-- Dark Mode Images -->
	<div class="absolute inset-0 hidden dark:block">
		<img
			src="/images/api-calls-dark.png"
			alt="Api Calls Dark Mode"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-100 slider-image-dark"
			data-index="0"
		/>
		<img
			src="/images/api-calls-kanagawa-dark.png"
			alt="Api Calls Kanagawa Dark"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-0 slider-image-dark"
			data-index="1"
		/>
		<img
			src="/images/api-calls-dracula-dark.png"
			alt="Api Calls Dracula Dark"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-0 slider-image-dark"
			data-index="2"
		/>
	</div>

	<!-- Light Mode Images -->
	<div class="absolute inset-0 block dark:hidden">
		<img
			src="/images/api-calls-light.png"
			alt="Api Calls Light Mode"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-100 slider-image-light"
			data-index="0"
		/>
		<img
			src="/images/api-calls-pink-light.png"
			alt="Api Calls Pink Light"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-0 slider-image-light"
			data-index="1"
		/>
		<img
			src="/images/api-calls-solarized-light.png"
			alt="Api Calls Solarized Light"
			class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 opacity-0 slider-image-light"
			data-index="2"
		/>
	</div>

	<!-- Indicators -->
	<div
		class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2 z-10 p-2 rounded-full bg-black/20 dark:bg-white/10 backdrop-blur-sm"
	>
		<button
			class="w-3 h-3 rounded-full border border-white/50 shadow-sm transition-all duration-300 indicator cursor-pointer hover:scale-110 focus:outline-none"
			data-index="0"
			aria-label="Slide 1"></button>
		<button
			class="w-3 h-3 rounded-full border border-white/50 shadow-sm transition-all duration-300 indicator cursor-pointer hover:scale-110 focus:outline-none"
			data-index="1"
			aria-label="Slide 2"></button>
		<button
			class="w-3 h-3 rounded-full border border-white/50 shadow-sm transition-all duration-300 indicator cursor-pointer hover:scale-110 focus:outline-none"
			data-index="2"
			aria-label="Slide 3"></button>
	</div>
</div>

<script>
	let slideInterval: ReturnType<typeof setInterval> | null = null;
	let themeObserver: MutationObserver | null = null;
	let currentIndex = 0;

	function initSlider() {
		// Clean up previous instance
		if (slideInterval) clearInterval(slideInterval);
		if (themeObserver) themeObserver.disconnect();

		const darkImages = document.querySelectorAll(".slider-image-dark");
		const lightImages = document.querySelectorAll(".slider-image-light");
		const indicators = document.querySelectorAll(".indicator");
		const glowElement = document.getElementById("image-glow");
		const heroGradient = document.getElementById("hero-gradient");
		const sliderContainer = document.querySelector(".slider-image-dark")?.closest("div[class*='aspect']");

		if (!sliderContainer) return;

		currentIndex = 0;
		const intervalTime = 5000;

		// Theme colors for each slide (dark mode and light mode)
		const themeColors = {
			dark: [
				"0, 170, 189",    // Default dark - cyan/turquoise
				"126, 156, 216",  // Kanagawa - blue/purple
				"189, 147, 249",  // Dracula - purple
			],
			light: [
				"0, 170, 189",    // Default light - cyan/turquoise
				"236, 72, 153",   // Pink - pink
				"181, 137, 0",    // Solarized - yellow/orange
			],
		};

		function updateColors(index: number) {
			const isDark = document.documentElement.classList.contains("dark");
			const rgb = isDark ? themeColors.dark[index] : themeColors.light[index];

			// Update glow behind image
			if (glowElement) {
				glowElement.style.background = `linear-gradient(to right, rgba(${rgb}, 0.2), rgba(${rgb}, 0.1), rgba(${rgb}, 0.2))`;
			}

			// Update hero background gradient
			if (heroGradient) {
				heroGradient.style.setProperty("--tw-gradient-from", `rgba(${rgb}, 0.05)`);
			}
		}

		function showSlide(index: number) {
			// Update Dark Mode Images
			darkImages.forEach((img, i) => {
				if (i === index) {
					img.classList.remove("opacity-0");
					img.classList.add("opacity-100");
				} else {
					img.classList.remove("opacity-100");
					img.classList.add("opacity-0");
				}
			});

			// Update Light Mode Images
			lightImages.forEach((img, i) => {
				if (i === index) {
					img.classList.remove("opacity-0");
					img.classList.add("opacity-100");
				} else {
					img.classList.remove("opacity-100");
					img.classList.add("opacity-0");
				}
			});

			// Update Indicators
			indicators.forEach((ind, i) => {
				if (i === index) {
					ind.classList.remove("bg-white/40", "hover:bg-white/60");
					ind.classList.add("bg-white", "scale-110");
				} else {
					ind.classList.remove("bg-white", "scale-110");
					ind.classList.add("bg-white/40", "hover:bg-white/60");
				}
			});

			// Update glow color
			updateColors(index);
		}

		function startSlideTimer() {
			if (slideInterval) clearInterval(slideInterval);
			slideInterval = setInterval(() => {
				currentIndex = (currentIndex + 1) % 3;
				showSlide(currentIndex);
			}, intervalTime);
		}

		// Check if already initialized (avoid duplicate listeners)
		if (!(sliderContainer as HTMLElement).dataset.initialized) {
			(sliderContainer as HTMLElement).dataset.initialized = "true";

			// Event Listeners for Indicators
			indicators.forEach((ind, i) => {
				ind.addEventListener("click", () => {
					currentIndex = i;
					showSlide(currentIndex);
					startSlideTimer(); // Reset timer on manual interaction
				});
			});
		}

		// Initial setup
		showSlide(0);
		startSlideTimer();

		// Update glow when theme changes
		themeObserver = new MutationObserver(() => {
			updateColors(currentIndex);
		});
		themeObserver.observe(document.documentElement, {
			attributes: true,
			attributeFilter: ["class"],
		});
	}

	// Initialize when DOM is ready
	if (document.readyState === "loading") {
		document.addEventListener("DOMContentLoaded", initSlider);
	} else {
		initSlider();
	}

	// Re-initialize after View Transitions
	document.addEventListener("astro:page-load", initSlider);
</script>
