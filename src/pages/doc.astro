---
import Layout from "../layouts/Layout.astro";
import { Code } from "astro:components";

const sections = [
	{ id: "goal", title: "Goal" },
	{ id: "installation", title: "Installation" },
	{ id: "first-run", title: "First Run" },
	{ id: "interface", title: "Interface" },
	{ id: "requests", title: "Building Requests" },
	{ id: "scripting", title: "Scripting" },
	{ id: "tabs", title: "Managing Tabs" },
	{ id: "collections", title: "Collections" },
	{ id: "environments", title: "Environments" },
	{ id: "header-priority", title: "Header Priority" },
	{ id: "history-cookies", title: "History & Cookies" },
	{ id: "workspaces", title: "Workspaces" },
	{ id: "settings", title: "Settings" },
	{ id: "updates", title: "Auto Updates" },
	{ id: "shortcuts", title: "Shortcuts" },
	{ id: "tips", title: "Tips" },
	{ id: "data", title: "Where Data Lives" },
	{ id: "resources", title: "Resources" },
];
---

<Layout
	title="Documentation"
	description="Comprehensive guide to using API Calls, including scripting, collections, and workspaces."
>
	<div class="bg-bg transition-colors duration-200">
		<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
			<!-- Mobile TOC Toggle -->
			<div class="lg:hidden sticky top-16 z-40 bg-bg py-4 border-b border-border">
				<button
					id="toc-toggle"
					class="flex items-center justify-between w-full px-4 py-2 text-sm font-medium text-text bg-surface rounded-lg border border-border"
				>
					<span>Table of Contents</span>
					<svg
						id="toc-chevron"
						class="w-5 h-5 transition-transform"
						fill="none"
						stroke="currentColor"
						viewBox="0 0 24 24"
					>
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"
						></path>
					</svg>
				</button>
				<nav id="mobile-toc" class="hidden mt-2 p-4 bg-surface rounded-lg border border-border">
					<ul class="space-y-2">
						{
							sections.map((section) => (
								<li>
									<a
										href={`#${section.id}`}
										class="toc-link block text-sm text-text-muted hover:text-primary transition-colors"
										data-section={section.id}
									>
										{section.title}
									</a>
								</li>
							))
						}
					</ul>
				</nav>
			</div>

			<div class="lg:grid lg:grid-cols-[250px_1fr] lg:gap-8 py-8 lg:py-16">
				<!-- Desktop TOC Sidebar -->
				<aside class="hidden lg:block">
					<nav class="sticky top-24 max-h-[calc(100vh-8rem)] overflow-y-auto pr-4">
						<h2 class="text-sm font-semibold text-text uppercase tracking-wide mb-4">
							On this page
						</h2>
						<ul class="space-y-1">
							{
								sections.map((section) => (
									<li>
										<a
											href={`#${section.id}`}
											class="toc-link block py-1.5 text-sm text-text-muted hover:text-primary border-l-2 border-transparent hover:border-primary pl-3 transition-all"
											data-section={section.id}
										>
											{section.title}
										</a>
									</li>
								))
							}
						</ul>
					</nav>
				</aside>

				<!-- Main Content -->
				<main class="min-w-0">
					<div class="text-center lg:text-left mb-12">
						<h1 class="text-3xl font-extrabold text-text sm:text-4xl">Usage Documentation</h1>
						<p class="mt-4 text-lg text-text-muted">
							Master API Calls with this comprehensive guide.
						</p>
					</div>

					<div class="space-y-16">
						<!-- Goal -->
						<section id="goal" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Goal</h2>
							<p class="mt-4 text-base text-text-muted">
								API Calls helps you exercise REST services without relying on a browser or external
								tools. It lets you craft HTTP requests, send them, inspect responses, and organise
								them into tabs, collections, and workspaces.
							</p>
							<div class="mt-6 rounded-md overflow-hidden">
								<img src="/images/api-calls.png" alt="Api Calls Interface" class="w-full h-auto" />
							</div>
						</section>

						<!-- Installation -->
						<section id="installation" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Requirements and Installation</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong class="text-text">Official packages</strong>: download the latest release
									for Linux, macOS, or Windows from GitHub Releases.
								</li>
								<li>
									<strong class="text-text">Arch Linux</strong>: available through the <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>api-calls-bin</code
									> package (AUR).
								</li>
								<li>
									<strong class="text-text">Running from source</strong>:
									<ol class="mt-2 list-decimal space-y-1 pl-5">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>npm install</code
											>
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>npm run dev</code
											> to launch the application in development mode.
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>npm run build:&lt;platform&gt;</code
											> to generate installers (linux/mac/win).
										</li>
									</ol>
								</li>
							</ul>
						</section>

						<!-- First Run -->
						<section id="first-run" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">First Run</h2>
							<ol class="mt-4 list-decimal space-y-2 pl-5 text-text-muted">
								<li>On launch, the default workspace opens with the side menu collapsed.</li>
								<li>
									Click <strong class="text-text">New Tab</strong> (the <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary">+</code
									> icon or <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+T</code
									>) to prepare a new request.
								</li>
								<li>
									Choose the HTTP method, enter the URL, and add the required parameters or body.
								</li>
								<li>
									Press <code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+Enter</code
									> or the <strong class="text-text">Send</strong> button to execute the request.
								</li>
								<li>Review the response at the bottom: status, duration, size, and body.</li>
							</ol>
						</section>

						<!-- Interface -->
						<section id="interface" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Interface at a Glance</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong class="text-text">Optional top menu</strong>: quick access to actions,
									view, tools, and updates (toggle from Settings or <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+M</code
									>).
								</li>
								<li>
									<strong class="text-text">Side menu</strong>: tabs for <em>Collections</em>, <em
										>Environments</em
									>, <em>History</em>, <em>Cookies</em>, and <em>Settings</em> (switch via shortcuts).
								</li>
								<li>
									<strong class="text-text">Side panel</strong>: displays the content of the
									selected section (collection tree, environments, etc.).
								</li>
								<li>
									<strong class="text-text">Central tabs</strong>: request editor, header/body
									configuration, and response viewer. Tabs support drag-and-drop reordering.
								</li>
								<li>
									<strong class="text-text">Bottom console</strong>: log of sent requests and
									debugging messages.
								</li>
							</ul>
						</section>

						<!-- Building Requests -->
						<section id="requests" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Building and Sending Requests</h2>
							<ol class="mt-4 list-decimal space-y-2 pl-5 text-text-muted">
								<li>
									<strong>Method and URL</strong>: use the selectors for GET, POST, PUT, PATCH,
									DELETE, and more. You can also define custom methods for non-standard HTTP verbs.
									URLs auto-complete with environment variables when selected.
								</li>
								<li><strong>Query parameters</strong>: add rows in the <em>Params</em> section.</li>
								<li>
									<strong>Path parameters</strong>: define dynamic URL segments using <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>:paramName</code
									> syntax (e.g., <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>/users/:id/posts/:postId</code
									>). Values can be set in the <em>Path</em> section.
								</li>
								<li>
									<strong>Headers</strong>: add request headers. They will overwrite collection
									headers.
								</li>
								<li>
									<strong>Body</strong>: choose the mode (JSON, YAML, text, form-data,
									x-www-form-urlencoded, file). The Monaco-based editor offers syntax highlighting.
								</li>
								<li>
									<strong>Authentication</strong>: configure authentication from the <em>Auth</em> tab:
									<ul class="mt-1 list-circle pl-5">
										<li>
											<strong>Bearer Token</strong>: adds an Authorization header with your token.
										</li>
										<li>
											<strong>Basic Auth</strong>: encodes username and password in the
											Authorization header.
										</li>
										<li>
											<strong>OAuth 2.0</strong>: supports the Authorization Code flow. Configure
											your client ID, client secret, authorization URL, and token URL. The app
											opens an integrated browser window to complete the OAuth flow and
											automatically retrieves the access token.
										</li>
										<li>
											<strong>Custom Token</strong>: add any custom header for authentication.
										</li>
									</ul>
								</li>
								<li>
									<strong>Environment</strong>: assign variables via <em>Environment</em> (collections
									can specify a preferred environment).
								</li>
								<li>
									<strong>Send and cancel</strong>: <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+Enter</code
									> sends the request, <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary">Esc</code
									> cancels it.
								</li>
							</ol>
						</section>

						<!-- Scripting -->
						<section id="scripting" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Scripting</h2>
							<p class="mt-4 text-base text-text-muted">
								You can write JavaScript code to execute before a request is sent (Pre-request
								Script) or after a response is received (Post-request Script). Scripts run in a
								secure sandbox with a 60-second timeout limit.
							</p>

							<h3 class="mt-6 text-xl font-bold text-text">Available Resources</h3>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong>console</strong>: Use <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>console.log(message)</code
									> or <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>console.error(message)</code
									>. Output appears in the bottom console.
								</li>
								<li>
									<strong>environment</strong>: access and modify environment variables.
									<ul class="mt-1 list-circle pl-5">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>environment.get(key)</code
											> - retrieve a variable value
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>environment.set(key, value)</code
											> - set or update a variable
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>environment.unset(key)</code
											> - remove a variable
										</li>
									</ul>
								</li>
								<li>
									<strong>http</strong>: Make asynchronous HTTP requests directly from your script.
									<ul class="mt-1 list-circle pl-5">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>await http.get(url, headers)</code
											>
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>await http.post(url, body, headers)</code
											>
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>await http.put(url, body, headers)</code
											>
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>await http.delete(url, headers)</code
											>
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>await http.request(method, url, body, headers)</code
											> - for any HTTP method
										</li>
									</ul>
								</li>
								<li>
									<strong>request</strong>: Access the current request details (method, URL, body,
									headers, queryParams).
								</li>
								<li>
									<strong>response</strong> (Post-script only): Access the received response
									(status, headers, body, rawBody).
								</li>
							</ul>

							<h3 class="mt-6 text-xl font-bold text-text">Script Examples</h3>
							<div class="mt-4 space-y-4">
								<div>
									<p class="text-sm font-medium text-text mb-2">
										Pre-request: Generate authentication token
									</p>
									<div class="code-block rounded-lg overflow-hidden border border-border [&_pre]:!m-0 [&_pre]:!rounded-none [&_pre]:!p-4">
										<Code
											code={`// Fetch a token before sending the request
const res = await http.post('https://api.example.com/auth', {
  username: environment.get('user'),
  password: environment.get('pass')
});
environment.set('token', res.body.access_token);
console.log('Token refreshed');`}
											lang="javascript"
											themes={{ light: "github-light", dark: "github-dark" }}
										/>
									</div>
								</div>
								<div>
									<p class="text-sm font-medium text-text mb-2">Post-request: Validate response</p>
									<div class="code-block rounded-lg overflow-hidden border border-border [&_pre]:!m-0 [&_pre]:!rounded-none [&_pre]:!p-4">
										<Code
											code={`// Check response status and extract data
if (response.status === 200) {
  const data = JSON.parse(response.body);
  environment.set('userId', data.id);
  console.log('User ID saved:', data.id);
} else {
  console.error('Request failed:', response.status);
}`}
											lang="javascript"
											themes={{ light: "github-light", dark: "github-dark" }}
										/>
									</div>
								</div>
							</div>
						</section>

						<!-- Managing Tabs -->
						<section id="tabs" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Managing Tabs</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong>Duplicate</strong>: right-click a tab and choose <em>Duplicate tab</em>.
								</li>
								<li>
									<strong>Restore</strong>: <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+Shift+T</code
									> reopens the last closed tab.
								</li>
								<li><strong>Move</strong>: drag tabs to reorder them.</li>
								<li>
									<strong>Search</strong>: open the tab switcher with <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+O</code
									> to find a tab by name.
								</li>
								<li>
									<strong>Close</strong>: <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+W</code
									> closes the active tab.
								</li>
								<li>
									<strong>Bulk close</strong>: right-click for <em>Close others</em> or <em
										>Close all</em
									>.
								</li>
								<li>
									<strong>Save a request</strong>: <code
										class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
										>Ctrl/Cmd+S</code
									> saves to the linked collection.
								</li>
							</ul>
						</section>

						<!-- Collections -->
						<section id="collections" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Collections</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>Create folders and sub-folders to group related requests.</li>
								<li>
									Assigning an environment to a collection propagates default variables to linked
									tabs.
								</li>
								<li>
									Use <em>Pre-request Script</em> and <em>Post-request Script</em> at the collection
									level to run JavaScript for all requests in the collection.
								</li>
								<li>
									Define collection headers that will be sent on all requests within the collection.
								</li>
								<li>
									<strong>Import and export</strong> from the context menu:
									<ul class="mt-1 list-circle pl-5">
										<li>
											<strong>Postman v2.1.0</strong>: full compatibility with Postman collections.
										</li>
										<li>
											<strong>OpenAPI 3.0.1</strong>: import API specifications and export your
											collections.
										</li>
										<li>
											<strong>JSON/YAML</strong>: custom API Calls format for backup and sharing.
										</li>
										<li>
											<strong>cURL</strong>: import cURL commands directly or export requests as
											cURL commands for sharing or terminal use.
										</li>
									</ul>
								</li>
							</ul>
						</section>

						<!-- Environments and Variables -->
						<section id="environments" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Environments and Variables</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									Define environments (dev, staging, prod) with key/value pairs.
									<ul class="mt-1 list-circle pl-5">
										<li>
											Insert variables as <code>{`{{variable}}`}</code> in URLs, headers, or bodies.
										</li>
										<li>Define environment headers that will be sent on requests.</li>
									</ul>
								</li>
								<li>Duplicate, reorder, or export complete environments as needed.</li>
								<li>Pick the active environment per tab from the request toolbar.</li>
							</ul>
						</section>

						<!-- Header Priority -->
						<section id="header-priority" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Header Priority</h2>
							<p class="mt-4 text-base text-text-muted">
								Headers can be defined at multiple levels. When the same header is defined in
								different places, higher priority levels override lower ones:
							</p>
							<ol class="mt-4 list-decimal space-y-2 pl-5 text-text-muted">
								<li>
									<strong class="text-text">Default headers</strong> (Settings) - lowest priority
								</li>
								<li><strong class="text-text">Workspace headers</strong></li>
								<li><strong class="text-text">Environment headers</strong></li>
								<li><strong class="text-text">Collection headers</strong></li>
								<li>
									<strong class="text-text">Request headers</strong> - highest priority
								</li>
							</ol>
							<p class="mt-4 text-sm text-text-muted">
								For example, if you set <code
									class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
									>Content-Type: application/xml</code
								> at the collection level but <code
									class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
									>Content-Type: application/json</code
								> at the request level, the request will use <code
									class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
									>application/json</code
								>.
							</p>
						</section>

						<!-- History and Cookies -->
						<section id="history-cookies" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">History and Cookies</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong>History</strong>: stores up to <code>maxHistory</code> requests. Reopen entries
									as tabs or clear them in bulk.
								</li>
								<li>
									<strong>Cookies</strong>: when <em>Manage cookies</em> is enabled, stored cookies are
									listed and can be cleared per domain.
								</li>
							</ul>
						</section>

						<!-- Workspaces -->
						<section id="workspaces" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Workspaces</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>Separate collections, environments, tabs, and cookies per project.</li>
								<li>Access the list and workspace actions from the side menu.</li>
								<li>
									Create, duplicate, rename, and remove workspaces. Each workspace is stored in its
									own file.
								</li>
							</ul>
						</section>

						<!-- Settings -->
						<section id="settings" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Settings</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<strong>Appearance</strong>:
									<ul class="mt-1 list-circle pl-5">
										<li>Theme selection (Auto, Light, Dark, High Contrast, or custom themes).</li>
										<li>Window mode: choose between custom or native title bar (Linux/Windows).</li>
										<li>Request view orientation: horizontal or vertical layout.</li>
									</ul>
								</li>
								<li>
									<strong>Behavior</strong>:
									<ul class="mt-1 list-circle pl-5">
										<li>Menu visibility toggle.</li>
										<li>Auto-scroll to active tab.</li>
										<li>Notifications and confirmation prompts.</li>
										<li>Save last response toggle.</li>
									</ul>
								</li>
								<li>
									<strong>Network</strong>:
									<ul class="mt-1 list-circle pl-5">
										<li>
											<strong>Request timeout</strong>: default is 30 seconds, adjust for slow
											APIs.
										</li>
										<li><strong>Follow redirects</strong>: automatically follow HTTP redirects.</li>
										<li>
											<strong>Reject unauthorized</strong>: disable to allow self-signed SSL
											certificates (useful for local development).
										</li>
										<li>
											<strong>Proxy configuration</strong>: route requests through an HTTP/HTTPS
											proxy for debugging or accessing internal networks.
										</li>
									</ul>
								</li>
								<li>
									<strong>Default headers</strong>: define headers that apply automatically to all
									requests (lowest priority in the header hierarchy).
								</li>
							</ul>
						</section>

						<!-- Auto Updates -->
						<section id="updates" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Auto Updates (Beta)</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>On macOS and Windows, the app checks for updates in the background.</li>
								<li>On Linux, install new versions manually.</li>
							</ul>
						</section>

						<!-- Essential Shortcuts -->
						<section id="shortcuts" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Essential Shortcuts</h2>
							<div class="mt-4 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
								<div>
									<h3 class="font-bold text-text">Tabs</h3>
									<ul class="mt-2 list-none space-y-1 text-text-muted">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+T</code
											> - New tab
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+W</code
											> - Close tab
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl+Tab</code
											> - Next tab
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl+Shift+Tab</code
											> - Previous tab
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+Shift+T</code
											> - Restore tab
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+O</code
											> - Find tab
										</li>
									</ul>
								</div>
								<div>
									<h3 class="font-bold text-text">Requests</h3>
									<ul class="mt-2 list-none space-y-1 text-text-muted">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+Enter</code
											> - Send request
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+S</code
											> - Save request
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+Shift+S</code
											> - Save as
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Esc</code
											> - Cancel request
										</li>
									</ul>
								</div>
								<div>
									<h3 class="font-bold text-text">Navigation</h3>
									<ul class="mt-2 list-none space-y-1 text-text-muted">
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+B</code
											> - Toggle sidebar
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+L</code
											> - Collections
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+E</code
											> - Environments
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+H</code
											> - History
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+G</code
											> - Cookies
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+,</code
											> - Settings
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+M</code
											> - Toggle menu
										</li>
										<li>
											<code class="rounded bg-surface px-1 py-0.5 text-sm font-mono text-primary"
												>Ctrl/Cmd+Shift+C</code
											> - Toggle console
										</li>
									</ul>
								</div>
							</div>
						</section>

						<!-- Tips -->
						<section id="tips" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Tips and Troubleshooting</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									If an HTTPS call fails, temporarily disable <em>Reject unauthorized</em> in Settings.
								</li>
								<li>Check the bottom console for validation messages.</li>
								<li>Use <em>Restore tab</em> to recover accidentally closed tabs.</li>
							</ul>
						</section>

						<!-- Where Data Lives -->
						<section id="data" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Where Data Lives</h2>
							<p class="mt-4 text-base text-text-muted">
								Collections, environments, tabs, and cookies are stored per workspace under
								Electron's user data directory.
							</p>
							<p class="mt-4 text-base text-text-muted">
								<strong class="text-text">No telemetry</strong>: API Calls does not collect or send
								any data to external servers. All your data stays on your machine.
							</p>
						</section>

						<!-- Additional Resources -->
						<section id="resources" class="scroll-mt-24">
							<h2 class="text-2xl font-bold text-text">Additional Resources</h2>
							<ul class="mt-4 list-disc space-y-2 pl-5 text-text-muted">
								<li>
									<a href="https://github.com/elpeix/apicalls" class="text-primary hover:underline"
										>GitHub repository</a
									>
								</li>
								<li>Issues: use <strong>Help > Submit bug</strong> or open a GitHub ticket.</li>
							</ul>
						</section>
					</div>
				</main>
			</div>
		</div>
	</div>
</Layout>

<style>
	.toc-link.active {
		color: var(--color-primary);
		border-color: var(--color-primary);
		font-weight: 500;
	}
</style>

<style is:global>
	/* Shiki dual theme support for class-based dark mode */
	.dark .code-block pre {
		background-color: var(--shiki-dark-bg) !important;
		color: var(--shiki-dark) !important;
	}
	.dark .code-block pre span {
		color: var(--shiki-dark) !important;
	}
</style>

<script>
	function initScrollSpy() {
		const sections = document.querySelectorAll("section[id]");
		const tocLinks = document.querySelectorAll(".toc-link");

		if (sections.length === 0 || tocLinks.length === 0) return;

		const observerOptions = {
			root: null,
			rootMargin: "-20% 0px -70% 0px",
			threshold: 0,
		};

		const observer = new IntersectionObserver((entries) => {
			entries.forEach((entry) => {
				if (entry.isIntersecting) {
					const id = entry.target.getAttribute("id");
					tocLinks.forEach((link) => {
						link.classList.remove("active");
						if (link.getAttribute("data-section") === id) {
							link.classList.add("active");
						}
					});
				}
			});
		}, observerOptions);

		sections.forEach((section) => observer.observe(section));

		// Mobile TOC toggle
		const tocToggle = document.getElementById("toc-toggle");
		const mobileToc = document.getElementById("mobile-toc");
		const tocChevron = document.getElementById("toc-chevron");

		if (tocToggle && mobileToc) {
			tocToggle.addEventListener("click", () => {
				mobileToc.classList.toggle("hidden");
				tocChevron?.classList.toggle("rotate-180");
			});

			// Close mobile TOC when clicking a link
			mobileToc.querySelectorAll("a").forEach((link) => {
				link.addEventListener("click", () => {
					mobileToc.classList.add("hidden");
					tocChevron?.classList.remove("rotate-180");
				});
			});
		}
	}

	// Initialize on page load
	initScrollSpy();

	// Re-initialize on Astro page navigation
	document.addEventListener("astro:page-load", initScrollSpy);
</script>
